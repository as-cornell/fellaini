
{#

/* -------------------------

Title: node--toc-page.html.twig
Descr: Sets up variables and content for _toc-page.twig
Passes: has-sidebar to contentWrapper

--------------------------- */

#}

{# Add main modifier #}
{% set main_element_modifiers = ['tocPage', 'has-sidebar'] %}

{# Content wrapper modifiers #}
{% set content_wrapper_modifiers = ['toc'] %}

{% set sidebar_wrapper_modifiers = ['toc'] %}
{% set asideLabelValue = drupal_token('node:title', {node: node}) %}
{% set asideLabelValue = asideLabelValue |check_markup('restricted_html') %}

{# link values for the toc items #}
{% set linkValues = [] %}
  {% for item in node.field_page_components_entity %}
    {% set linkValues = linkValues|merge([item.entity.name.0.value]) %}
  {% endfor %}


{# 
  - TOC sidebar has nav, and aside components if present
  - add siebar_nav to sidebar
  - if aside content set aside_content
  - set sidebar = true
  - add aside into sidebar if defined
 #}
 
{% set sidebar = true %}
{% set sidebar_content %}
  {% set sidebar_nav %}
    {{ drupal_block('toc_aside_block', {label: asideLabelValue, link_values:linkValues}) }}
  {% endset %}
    {{sidebar_nav}}
  {% set sidebarNav = true %}
  {% if content.field_aside_components|render is not empty %}
    {{content.field_aside_components}}
  {% endif %}

{% endset %}


{% include "@pages/toc-page/_toc-page.twig" with {
    title : label,

    main_content : content.field_page_components_entity,
    sidebar_content : sidebar_content,

    content_wrapper_modifiers : content_wrapper_modifiers,
    main_content_modifiers : main_content_modifiers,
    sidebar_wrapper_modifiers : sidebar_wrapper_modifiers

    }
%}


